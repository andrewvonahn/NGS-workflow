###Calculate depth by region, extract depth information for the region chromosome_1:10001-10010 from Chlamydomonas strain CR2342

$ samtools depth -r chromosome_1:10001-10010 /scratch/courses/BI7653/hw7.2018/CR2342.bam

###What is the read depth at position 10,001 on chromosome_1?
chromosome_1	10001	241

###What is the coverage (“mean” depth) in the interval chromosome_1:10001-10010?
The coverage in the interval chromosome_1:10001-10010 is 266.2



####Generate depth for all positions on chromosome_1 for both samples CR407 and CR2342.   For this, you will need the length of chromosome_1 in the Chlamydomonas reference genome which is 8,033,585.  Your output file should have 8 million+ depths, one for each position.
####For your answer, report the depth of the last 10 positions in both CR407 and CR2342 outputs (tail -10 <samtools depth output>)

chromosome_1	8033576	3
chromosome_1	8033577	3
chromosome_1	8033578	2
chromosome_1	8033579	2
chromosome_1	8033580	2
chromosome_1	8033581	2
chromosome_1	8033582	2
chromosome_1	8033583	1
chromosome_1	8033584	1
chromosome_1 8033585	0


##bin the depth calculated at each position 

##In order to calculate coverage for intervals on chromosome_1, we need to bin each position in your Q1.2 outputs into an interval, or window. 

For Q1.3, use the bedtools software suite to bin the depth data into 500 bp intervals. This package developed by Aaron Quinlan and colleagues has been described as a genomics “swiss army knife”.  It is well worth your time to familiarize yourself with the full array of capabilities as we won’t even scratch the surface here:

http://bedtools.readthedocs.io/en/latest/content/bedtools-suite.html

In Q1.4 below, you will use bedtools intersect to assign each position (and its depth) to a bin.  However, before implementing bedtools intersect in Q1.4, we first need to convert the samtools depth output from Q1.2 into BED format. 

For example, samtools depth output for position 10 on chromosome_1 in Q1.2 looks like:

chromosome_1	10	<depth>

But we need to convert to the following BED4 format for bedtools,

chromosome_1	9	10	<depth>

You can do this conversion at the command line using AWK or run the following perl one-liner from the command line on outputs from Q1.2 (you will run twice, once for each sample):

perl -F’\t’ -lane ‘print join(“\t”,$F[0],$F[1] - 1, $F[1],$F[2])’ <Q1.2 output> > <Q1.3 output>

Report both command lines and the first 10 lines of the CR407 output file for your answer (e.g., head -10 <file>) 

$ awk '{print $1"\t"$2-1"\t"$2"\t"$3}' CR407.txt > CR407.bed
$ awk '{print $1"\t"$2-1"\t"$2"\t"$3}' CR2342.txt > CR2342.bed
